---
layout:     post
title:      既然CPU同一时间只能执行一个线程，为什么存在并发问题？
subtitle:   cpu,线程
date:       2020-04-18
author:     298
header-img: img/70858371_p0.jpg
catalog: 	 true
tags:
    - cpu
    - 线程
---

一点小疑惑终于解开啦

CPU的时间是按时间片分的，而不是一个时间点，并发问题是由于CPU线程切换导致的。
　　现在假设有一段代码

```python
if(i == 1) {
    i++; # 断点1
    system.out.print(i);       
}　# 断点2
```



　　有两个线程A，B同时执行这一段代码，假设A线程先被CPU调度，然而A线程在断点1处，时间片到期了，此时A线程的代码并没有执行完，但是CPU此时会调度B线程，并不会管A线程是不是执行完了这一段代码。

​		再接着假设B线程现在执行完了这一段代码(当然也可能没有执行完)，CPU 现在就又会调度A线程，并且从A线程的断点1处继续执行(注意不是重新执行，CPU切换的时候保存了线程的上下文)

　　**总结一下：CPU切换线程并不会管你线程是否将代码执行完，而是和分给线程的时间片是否到期有关，时间片到期了就会切换线程，并发也就由此产生了。**
